#!/usr/bin/env ruby

$: << File.expand_path(File.dirname(__FILE__)) + '/../lib'

require 'args_parser'
require 'ed2k'

def main
  case $options[:action]
  when :hash
    puts Ed2k.hash_file($options[:file], :upcase => $options[:upcase])
  when :aich
    puts Ed2k.aich_file($options[:file], :upcase => $options[:upcase])
  when :link
    puts Ed2k.build_ed2k($options[:file], :upcase => $options[:upcase])
  end
end

unless Ed2k.debuging?
  begin
    main
  rescue
    $stderr.puts $!
    exit 1
  end
else
  main
end
